27/06/2022 17:12:46 Error 949 ShowFrmBatchReceipt() :Form that is already visible cannot be displayed as a modal dialog box. Set the form's visible property to false before calling Show.
24/06/2022 11:17:10  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0439'  
 AND ARIBH.DATEINVC BETWEEN '20220401' AND '20220404' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-00022' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0439'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220401' AND '20220404' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:58  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0053'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-999' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0053'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:57  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0053'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-999' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0053'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:57  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0053'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-999' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0053'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:56  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0053'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-999' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0053'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:55  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0053'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-999' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0053'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:55  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0053'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-999' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0053'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:54  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0053'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-999' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0053'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:54  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0053'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-999' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0053'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:53  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0053'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-999' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0053'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:53  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0053'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-999' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0053'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:52  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0053'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-999' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0053'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:43  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-00032' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:42  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-00032' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:41  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-00032' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:41  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-00032' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:40  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-00032' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:39  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220102' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-00032' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220102' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:33  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220202' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-00032' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220202' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:33  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220202' AND '20220202' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-00032' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220202' AND '20220202' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:18  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0160'  
 AND ARIBH.DATEINVC BETWEEN '20220201' AND '20220404' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-1003' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0160'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220201' AND '20220404' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:04  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0160'  
 AND ARIBH.DATEINVC BETWEEN '20220201' AND '20220404' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-1003' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0160'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220201' AND '20220404' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:04  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0160'  
 AND ARIBH.DATEINVC BETWEEN '20220201' AND '20220404' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-1003' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0160'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220201' AND '20220404' 
ORDER BY INVNO,INVDATE

24/06/2022 11:16:03  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0160'  
 AND ARIBH.DATEINVC BETWEEN '20220201' AND '20220404' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-1003' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0160'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220201' AND '20220404' 
ORDER BY INVNO,INVDATE

24/06/2022 11:15:55  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0160'  
 AND ARIBH.DATEINVC BETWEEN '20220201' AND '20220404' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-1003' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0160'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220201' AND '20220404' 
ORDER BY INVNO,INVDATE

24/06/2022 11:15:38  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220202' AND '20220430' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-0998' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220202' AND '20220430' 
ORDER BY INVNO,INVDATE

24/06/2022 11:15:38  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220202' AND '20220430' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-0998' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220202' AND '20220430' 
ORDER BY INVNO,INVDATE

24/06/2022 11:15:38  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220202' AND '20220430' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-0998' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220202' AND '20220430' 
ORDER BY INVNO,INVDATE

24/06/2022 11:15:37  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220202' AND '20220430' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-0998' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220202' AND '20220430' 
ORDER BY INVNO,INVDATE

24/06/2022 11:15:34  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220202' AND '20220404' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-0998' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220202' AND '20220404' 
ORDER BY INVNO,INVDATE

24/06/2022 11:15:33  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220202' AND '20220404' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-0998' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220202' AND '20220404' 
ORDER BY INVNO,INVDATE

24/06/2022 11:15:33  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220202' AND '20220404' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-0998' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220202' AND '20220404' 
ORDER BY INVNO,INVDATE

24/06/2022 11:15:32  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011'  
 AND ARIBH.DATEINVC BETWEEN '20220202' AND '20220404' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-0998' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220202' AND '20220404' 
ORDER BY INVNO,INVDATE

24/06/2022 11:14:59 Error 875 MergeTransactionBill() :Conversion from string "" to type 'Double' is not valid.
24/06/2022 11:14:59  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0160'  
 AND ARIBH.DATEINVC BETWEEN '20220201' AND '20220430' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-1003' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0160'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220201' AND '20220430' 
ORDER BY INVNO,INVDATE

24/06/2022 11:14:37 Error 875 MergeTransactionBill() :Conversion from string "" to type 'Double' is not valid.
24/06/2022 11:14:37  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0160'  
 AND ARIBH.DATEINVC BETWEEN '20220201' AND '20220404' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND (FMSBILLDETAIL.BILLNO = 'BTS-1003' or FMSBILLDETAIL.BILLNO IS NULL )
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0160'
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220201' AND '20220404' 
ORDER BY INVNO,INVDATE

23/06/2022 16:50:01  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0011        '  
 AND ARIBH.DATEINVC BETWEEN '20220101' AND '20220623' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0011        '
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220101' AND '20220623' 
ORDER BY INVNO,INVDATE

23/06/2022 16:49:54  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0435        '  
 AND ARIBH.DATEINVC BETWEEN '20220101' AND '20220623' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0435        '
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220101' AND '20220623' 
ORDER BY INVNO,INVDATE

23/06/2022 16:49:54  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0435        '  
 AND ARIBH.DATEINVC BETWEEN '20220101' AND '20220623' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0435        '
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220101' AND '20220623' 
ORDER BY INVNO,INVDATE

23/06/2022 16:49:53  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0435        '  
 AND ARIBH.DATEINVC BETWEEN '20220101' AND '20220623' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0435        '
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220101' AND '20220623' 
ORDER BY INVNO,INVDATE

23/06/2022 16:49:53  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0435        '  
 AND ARIBH.DATEINVC BETWEEN '20220101' AND '20220623' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0435        '
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220101' AND '20220623' 
ORDER BY INVNO,INVDATE

23/06/2022 16:49:52  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0435        '  
 AND ARIBH.DATEINVC BETWEEN '20220101' AND '20220623' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0435        '
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220101' AND '20220623' 
ORDER BY INVNO,INVDATE

23/06/2022 16:49:52  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0435        '  
 AND ARIBH.DATEINVC BETWEEN '20220101' AND '20220623' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0435        '
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220101' AND '20220623' 
ORDER BY INVNO,INVDATE

23/06/2022 16:49:33  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0160        '  
 AND ARIBH.DATEINVC BETWEEN '20220101' AND '20220623' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0160        '
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220101' AND '20220623' 
ORDER BY INVNO,INVDATE

23/06/2022 16:49:29  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0160        '  
 AND ARIBH.DATEINVC BETWEEN '20220101' AND '20220623' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0160        '
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220101' AND '20220623' 
ORDER BY INVNO,INVDATE

23/06/2022 16:49:28  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0160        '  
 AND ARIBH.DATEINVC BETWEEN '20220101' AND '20220623' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0160        '
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220101' AND '20220623' 
ORDER BY INVNO,INVDATE

23/06/2022 16:49:26  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0160        '  
 AND ARIBH.DATEINVC BETWEEN '20220101' AND '20220623' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0160        '
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220101' AND '20220623' 
ORDER BY INVNO,INVDATE

23/06/2022 16:49:25  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = '0160        '  
 AND ARIBH.DATEINVC BETWEEN '20220101' AND '20220623' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = '0160        '
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220101' AND '20220623' 
ORDER BY INVNO,INVDATE

23/06/2022 16:49:15  633 (GETDATA_SOURCEBILLDETAIL) :SELECT
AROBL.IDCUST AS IDCUST --AROBL.IDCUST
,AROBL.IDINVC AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEINVC AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),7,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),5,2) + '/' + SUBSTRING(CAST(ARIBH.DATEDUE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,AROBL.IDCUSTPO AS PONUM -->AROBL.IDCUSTPO 
,AROBL.AMTDUETC AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	Else Case When  (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then 0 
		Else (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			End End As AMTOUTSTAND 
,CASE WHEN FMSBILLDETAIL.LINEAMOUNT Is NULL THEN AROBL.AMTDUETC 
	ELSE CASE WHEN (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 <> 5),0)) = 0 Then AROBL.AMTDUETC 
		ELSE (FMSBILLDETAIL.LINEAMOUNT - ISNULL((Select SUM(FMSBILLDETAIL.NETAMT) As VALUE FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC And FMSBILLDETAIL.STA_0 NOT IN (4,5)),0))  
			END END AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,AROBL.CODETERM AS TERMCODE
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLNO,'') AS BILLNO
FROM AROBL 
LEFT OUTER JOIN ARIBH ON AROBL.IDINVC = ARIBH.IDINVC AND AROBL.IDCUST = ARIBH.IDCUST 
AND AROBL.CNTBTCH = ARIBH.CNTBTCH AND AROBL.CNTITEM = ARIBH.CNTITEM 
LEFT OUTER JOIN BILL2022.dbo.FMSBILLDETAIL  ON FMSBILLDETAIL.INVNO = AROBL.IDINVC AND FMSBILLDETAIL.IDCUST = AROBL.IDCUST
AND FMSBILLDETAIL.BILLSEQ = (SELECT MAX(FMSBILLDETAIL.BILLSEQ) FROM BILL2022.dbo.FMSBILLDETAIL WHERE FMSBILLDETAIL.INVNO = AROBL.IDINVC)

WHERE AROBL.IDCUST = ''  
 AND ARIBH.DATEINVC BETWEEN '20220601' AND '20220623' 
AND (AROBL.TRXTYPETXT = 1 OR AROBL.TRXTYPETXT = 2 OR AROBL.TRXTYPETXT = 3) 
AND AROBL.AMTDUETC <> 0 
AND ARIBH.SPECINST IN ('NON BOI','NONBOI','')  
UNION ALL
SELECT
 FMSBILLDETAIL.IDCUST AS IDCUST --AROBL.IDCUST 
,FMSBILLDETAIL.INVNO AS INVNO -- AROBL.IDINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.INVDATE AS CHAR),1,4) AS INVDATE --> ARIBH.DATEINVC 
,SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),7,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),5,2) + '/' + SUBSTRING(CAST(FMSBILLDETAIL.DUEDATE AS CHAR),1,4)  AS DUEDATE --> ARIBH.DATEDUE 
,FMSBILLDETAIL.PONUM AS PONUM -->AROBL.IDCUSTPO 
,FMSBILLDETAIL.LINEAMOUNT AS LINEAMOUNT --> AROBL.AMTDUETC - Sum(FMSBILLDETAIL.LINEAMOUNT) 
,FMSBILLDETAIL.AMTOUTSTAND AS AMTOUTSTAND 
,FMSBILLDETAIL.NETAMT AS NETAMT 
,CASE WHEN FMSBILLDETAIL.BILLNO IS NULL THEN 'False' ELSE 'False' END  AS CHECK_0 --> KEY-IN 
,'' AS STA_0 --> KEY-IN 
,'' AS TERMCODE 
,ISNULL(FMSBILLDETAIL.BILLDTEXT1,'') AS BILLDTEXT1 --> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT2,'') AS BILLDTEXT2--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT3,'') AS BILLDTEXT3--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT4,'') AS BILLDTEXT4--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT5,'') AS BILLDTEXT5--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT6,'') AS BILLDTEXT6--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT7,'') AS BILLDTEXT7--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT8,'') AS BILLDTEXT8--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT9,'') AS BILLDTEXT9--> KEY-IN 
,ISNULL(FMSBILLDETAIL.BILLDTEXT10,'') AS BILLDTEXT10--> KEY-IN 
,CASE WHEN FMSBILLDETAIL.STA_0 = 4 OR FMSBILLDETAIL.STA_0 = 5  THEN '' ELSE FMSBILLDETAIL.BILLNO  END AS BILLNO
FROM BILL2022.dbo.FMSBILLDETAIL 
WHERE FMSBILLDETAIL.IDCUST = ''
AND FMSBILLDETAIL.STA_0 = 4 
 AND FMSBILLDETAIL.INVDATE BETWEEN '20220601' AND '20220623' 
ORDER BY INVNO,INVDATE

23/06/2022 8:20:58 Error 949 ShowFrmBatchReceipt() :Form that is already visible cannot be displayed as a modal dialog box. Set the form's visible property to false before calling Show.
22/06/2022 17:28:06 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0300' AND  '0300' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0300' AND  '0300' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]
22/06/2022 17:28:03 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0300' AND  '0300' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0300' AND  '0300' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]
22/06/2022 11:04:50 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0300' AND  '0300' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0300' AND  '0300' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]
22/06/2022 11:04:48 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0300' AND  '0300' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0300' AND  '0300' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]
22/06/2022 9:27:12 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '' AND  'ZZZZZZ' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '' AND  'ZZZZZZ' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]
22/06/2022 8:20:03 Error 15 (FrmOPEN_Load) :ExecuteReader requires an open and available Connection. The connection's current state is closed.
22/06/2022 8:20:03 Error 165 (Openconnect) :Cannot open database "BILL2022" requested by the login. The login failed.
Login failed for user 'sa'.
22/06/2022 8:19:46 Error 15 (FrmOPEN_Load) :ExecuteReader requires an open and available Connection. The connection's current state is closed.
22/06/2022 8:19:46 Error 165 (Openconnect) :Cannot open database "BILL2022" requested by the login. The login failed.
Login failed for user 'sa'.
22/06/2022 8:19:44 Error 15 (FrmOPEN_Load) :ExecuteReader requires an open and available Connection. The connection's current state is closed.
22/06/2022 8:19:44 Error 165 (Openconnect) :Cannot open database "BILL2022" requested by the login. The login failed.
Login failed for user 'sa'.
22/06/2022 8:19:42 Error 15 (FrmOPEN_Load) :ExecuteReader requires an open and available Connection. The connection's current state is closed.
22/06/2022 8:19:42 Error 165 (Openconnect) :Cannot open database "BILL2022" requested by the login. The login failed.
Login failed for user 'sa'.
21/06/2022 17:07:13 Error 15 (FrmOPEN_Load) :ExecuteReader requires an open and available Connection. The connection's current state is closed.
21/06/2022 17:07:13 Error 165 (Openconnect) :Cannot open database "BILL2022" requested by the login. The login failed.
Login failed for user 'sa'.
21/06/2022 17:06:57 Error 15 (FrmOPEN_Load) :ExecuteReader requires an open and available Connection. The connection's current state is closed.
21/06/2022 17:06:57 Error 165 (Openconnect) :Cannot open database "BILL2022" requested by the login. The login failed.
Login failed for user 'sa'.
21/06/2022 17:06:57 Error 15 (FrmOPEN_Load) :ExecuteReader requires an open and available Connection. The connection's current state is closed.
21/06/2022 17:06:57 Error 165 (Openconnect) :Cannot open database "BILL2022" requested by the login. The login failed.
Login failed for user 'sa'.
21/06/2022 17:06:55 Error 15 (FrmOPEN_Load) :ExecuteReader requires an open and available Connection. The connection's current state is closed.
21/06/2022 17:06:55 Error 165 (Openconnect) :Cannot open database "BILL2022" requested by the login. The login failed.
Login failed for user 'sa'.
21/06/2022 17:06:53 Error 15 (FrmOPEN_Load) :ExecuteReader requires an open and available Connection. The connection's current state is closed.
21/06/2022 17:06:53 Error 165 (Openconnect) :Cannot open database "BILL2022" requested by the login. The login failed.
Login failed for user 'sa'.
21/06/2022 16:21:35 Error 430 DisplayDGVRCP() : Conversion from string "Open" to type 'Double' is not valid.
21/06/2022 15:52:17 <ImportAccpac>Import Complete RCT-99
21/06/2022 15:52:10 01/02/2022
21/06/2022 15:52:10 01/02/2022
21/06/2022 15:52:10 01/02/2022
21/06/2022 15:48:03 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0505' AND  '0505' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0505' AND  '0505' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]
17/06/2022 15:35:45 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0043' AND  '0043' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0043' AND  '0043' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]
17/06/2022 15:35:42 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '' AND  'ZZZZZZ' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '' AND  'ZZZZZZ' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]
17/06/2022 15:33:12 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0043' AND  '0043' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0043' AND  '0043' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]
17/06/2022 15:33:10 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '' AND  'ZZZZZZ' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '' AND  'ZZZZZZ' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]
17/06/2022 15:30:53 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0043' AND  '0043' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0043' AND  '0043' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]
17/06/2022 15:30:50 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '' AND  'ZZZZZZ' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '' AND  'ZZZZZZ' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]
17/06/2022 15:30:07 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0043' AND  '0043' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0043' AND  '0043' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]
17/06/2022 15:30:05 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '' AND  'ZZZZZZ' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '' AND  'ZZZZZZ' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]
17/06/2022 15:29:14 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0043' AND  '0043' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '0043' AND  '0043' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]
17/06/2022 15:29:12 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number], FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST AND FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                              --AND FMSRCPDETAIL.RCPNO IS NULL
                                --AND (FMSRCPDETAIL.AMTOUTSTAND <> 0 OR FMSRCPDETAIL.AMTOUTSTAND IS NULL)
                                --14/06/2022
                                and FMSBILLHEAD.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 2)
and FMSBILLHEAD.BILLNO not in (select  FMSRCPDETAIL.BILLNO
from FMSRCPDETAIL inner join FMSBILLHEAD on FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO 
where FMSRCPDETAIL.STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0
)

                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '' AND  'ZZZZZZ' 
                             AND FMSBILLHEAD.BILLNO LIKE '%%' 
 UNION 
							 SELECT DISTINCT  FMSBILLHEAD.BILLNO AS [Billing Note Number] , FMSBILLHEAD.IDCUST AS [Customer Number], NAMECUST AS [Customer Name], FORMAT(FMSBILLHEAD.NETAMT,'N') AS [Amount]
                             FROM FMSBILLHEAD 
                             LEFT OUTER JOIN FMSRCPDETAIL ON  FMSBILLHEAD.IDCUST = FMSRCPDETAIL.IDCUST 
                             LEFT OUTER JOIN FMSARCUSMASTER ON FMSBILLHEAD.IDCUST = FMSARCUSMASTER.IDCUST 
                             WHERE 
                              FMSBILLHEAD.STA_0 = 2 
                             AND FMSRCPDETAIL.STA_0 = 5
                                AND FMSRCPDETAIL.BILLNO not in (select BILLNO from FMSRCPDETAIL where STA_0 = 1 and FMSBILLHEAD.NETAMT - (select sum(FMSRCPDETAIL.NETAMT) from FMSRCPDETAIL where FMSRCPDETAIL.BILLNO = FMSBILLHEAD.BILLNO and FMSRCPDETAIL.STA_0 = 1   ) = 0)
                             AND FMSBILLHEAD.AUDTORG = 'SAM69L'
                             AND FMSBILLHEAD.IDCUST BETWEEN '' AND  'ZZZZZZ' 
 AND FMSBILLHEAD.BILLNO LIKE '%%' ORDER BY [Billing Note Number]



























































































